<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LINE é ç´„ç³»çµ± - LIFF å¯¦æˆ°ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- 1. å¼•å…¥ LINE LIFF SDK (å¿…è¦) -->
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        /* Custom Font */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f3f4f6; 
            height: 100vh;
            overflow: hidden;
        }

        .app-container {
            background-color: #ffffff;
            height: 100%;
            overflow-y: auto;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .chart-container {
            position: relative;
            width: 100%;
            height: 300px;
        }

        .tab-active { color: #06C755; font-weight: 700; }
        .tab-inactive { color: #9CA3AF; }

        .calendar-day {
            aspect-ratio: 1;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; border-radius: 50%; transition: all 0.2s;
        }
        .calendar-day:hover:not(.disabled) { background-color: #f0fdf4; }
        .calendar-day.selected { background-color: #06C755; color: white; }
        .calendar-day.disabled { color: #e5e7eb; cursor: not-allowed; }

        /* Chat UI */
        .chat-bubble { max-width: 80%; padding: 10px 14px; border-radius: 18px; font-size: 14px; line-height: 1.5; margin-bottom: 10px; word-wrap: break-word; }
        .chat-bubble.user { background-color: #06C755; color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
        .chat-bubble.ai { background-color: #f3f4f6; color: #1f2937; align-self: flex-start; border-bottom-left-radius: 4px; }
        
        .loading-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.9); z-index: 100;
            display: flex; justify-content: center; align-items: center; flex-direction: column;
        }
    </style>
    <!-- 
      CONFIG SETUP INSTRUCTIONS:
      1. Obtain LIFF ID from LINE Developers Console.
      2. Deploy a Google Apps Script (GAS) as Web App to get the backend URL.
      3. Fill in the 'liffId' and 'backendUrl' constants below.
    -->
</head>
<body class="text-gray-800">

    <!-- Loading Screen for LIFF Init -->
    <div id="liff-loader" class="loading-overlay hidden">
        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-[#06C755] mb-4"></div>
        <p class="text-sm text-gray-500 font-bold">æ­£åœ¨é€£æ¥ LINE...</p>
    </div>

    <div class="flex h-full max-w-7xl mx-auto shadow-2xl overflow-hidden rounded-none md:rounded-xl">
        
        <!-- CLIENT APP -->
        <div id="client-app" class="w-full md:w-[450px] md:border-r border-gray-200 flex-shrink-0 z-10 transition-all duration-300">
            <div class="app-container no-scrollbar">
                
                <header class="bg-white sticky top-0 z-20 border-b border-gray-100 px-4 py-3 flex items-center justify-between shadow-sm">
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-[#06C755] rounded-lg flex items-center justify-center text-white font-bold text-lg">L</div>
                        <h1 class="text-lg font-bold text-gray-800">LINE é ç´„ç³»çµ±</h1>
                    </div>
                    <!-- Status Indicator -->
                    <div id="connection-status" class="text-[10px] bg-gray-100 px-2 py-1 rounded text-gray-500">
                        æ¨¡æ“¬æ¨¡å¼
                    </div>
                </header>

                <main id="app-content" class="flex-grow p-4 pb-24"></main>

                <nav class="bg-white border-t border-gray-100 absolute bottom-0 w-full h-16 flex justify-around items-center px-2 shadow-[0_-2px_10px_rgba(0,0,0,0.05)] z-30">
                    <button onclick="navigateTo('home')" class="nav-item flex flex-col items-center space-y-1 w-1/4" data-target="home">
                        <span class="text-2xl">ğŸ </span><span class="text-[10px]">é¦–é </span>
                    </button>
                    <button onclick="navigateTo('services')" class="nav-item flex flex-col items-center space-y-1 w-1/4" data-target="services">
                        <span class="text-2xl">ğŸ“…</span><span class="text-[10px]">é ç´„</span>
                    </button>
                    <button onclick="navigateTo('records')" class="nav-item flex flex-col items-center space-y-1 w-1/4" data-target="records">
                        <span class="text-2xl">ğŸ“‹</span><span class="text-[10px]">ç´€éŒ„</span>
                    </button>
                    <button onclick="navigateTo('profile')" class="nav-item flex flex-col items-center space-y-1 w-1/4" data-target="profile">
                        <span class="text-2xl">ğŸ‘¤</span><span class="text-[10px]">æˆ‘çš„</span>
                    </button>
                </nav>
            </div>
        </div>

        <!-- ADMIN DASHBOARD (Simplified for brevity, same logic as before) -->
        <div id="admin-dashboard" class="hidden md:block flex-grow bg-gray-50 overflow-y-auto h-full">
            <div class="p-8">
                <h2 class="text-3xl font-bold text-gray-800 mb-2">å¾Œå°æ¨¡æ“¬</h2>
                <p class="text-gray-600 mb-8">æ­¤è™•é¡¯ç¤ºçš„æ˜¯æ¨¡æ“¬æ•¸æ“šã€‚è‹¥é€£æ¥çœŸå¯¦å¾Œç«¯ï¼Œæ•¸æ“šæ‡‰å¾ Google Sheets è®€å–ã€‚</p>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                     <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col h-80">
                        <h3 class="font-bold text-lg mb-4 text-gray-800">ç‡Ÿæ”¶é è¦½</h3>
                        <div class="chart-container flex-grow"><canvas id="revenueChart"></canvas></div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col h-80">
                        <h3 class="font-bold text-lg mb-4 text-gray-800">æœå‹™ä½”æ¯”</h3>
                        <div class="chart-container flex-grow"><canvas id="categoryChart"></canvas></div>
                    </div>
                </div>
            </div>
        </div>

        <button id="mobile-toggle" class="md:hidden fixed bottom-20 right-4 bg-gray-800 text-white p-3 rounded-full shadow-lg z-50">ğŸ“Š</button>
    </div>

    <script>
        // --- CONFIGURATION (ä½¿ç”¨è€…éœ€å¡«å¯«) ---
        const LIFF_ID = "2008849711-IGFBS0QP"; // å¡«å…¥ä½ çš„ LIFF ID (ä¾‹å¦‚: 1657000000-xxxxxx)
        const BACKEND_URL = "https://script.google.com/macros/s/AKfycbwWl1g7SxYk4TRxHzaSiVn2OcP6_DYjKW7KP0cYoAHQeBlfAdgLWnDokBa5LGPNtVjU/exec"; // å¡«å…¥ä½ çš„ Google Apps Script Web App URL
        const API_KEY = ""; // Google Gemini API Key

        // --- CORE DATA ---
        const storeData = {
            services: [
                { id: 's1', name: 'ç²¾ç·»å‰ªé«®', price: 600, duration: 60, icon: âœ‚ï¸' },
                { id: 's2', name: 'æŸ“é«®è¨­è¨ˆ', price: 2500, duration: 120, icon: 'ğŸ¨' },
                { id: 's3', name: 'é ­çš®è­·ç†', price: 1200, duration: 90, icon: 'ğŸ’†' },
                { id: 's4', name: 'ç¾ç”²ä¿é¤Š', price: 800, duration: 60, icon: 'ğŸ’…' }
            ],
            staff: [
                { id: 'st1', name: 'Alice', image: 'ğŸ‘©â€ğŸ¦°' },
                { id: 'st2', name: 'Bob', image: 'ğŸ‘¨â€ğŸ¦±' },
                { id: 'st0', name: 'ä¸æŒ‡å®š', image: 'âœ¨' }
            ],
            user: { 
                userId: 'guest', 
                displayName: 'è¨ªå®¢', 
                pictureUrl: '',
                isLineUser: false 
            },
            bookings: [] 
        };

        let state = {
            currentView: 'home',
            bookingFlow: { service: null, staff: null, date: null, time: null, note: '' }
        };

        // --- LIFF INITIALIZATION ---
        async function initLiff() {
            if (!LIFF_ID) {
                console.log('No LIFF ID provided. Running in web mode.');
                return;
            }

            const loader = document.getElementById('liff-loader');
            loader.classList.remove('hidden');

            try {
                await liff.init({ liffId: LIFF_ID });
                
                if (liff.isLoggedIn()) {
                    const profile = await liff.getProfile();
                    storeData.user = {
                        userId: profile.userId,
                        displayName: profile.displayName,
                        pictureUrl: profile.pictureUrl,
                        isLineUser: true
                    };
                    document.getElementById('connection-status').innerText = "å·²é€£ç·š LINE";
                    document.getElementById('connection-status').classList.replace('bg-gray-100', 'bg-green-100');
                    document.getElementById('connection-status').classList.replace('text-gray-500', 'text-green-600');
                    
                    // Trigger Re-render to show User Name
                    renderView('home'); 
                } else {
                    liff.login(); // Force login if opened in LINE but not logged in
                }
            } catch (err) {
                console.error('LIFF Init Failed', err);
                alert('LIFF åˆå§‹åŒ–å¤±æ•—: ' + err.message);
            } finally {
                loader.classList.add('hidden');
            }
        }

        // --- NAVIGATION & RENDERING ---
        const appContent = document.getElementById('app-content');

        function navigateTo(view) {
            state.currentView = view;
            updateTabStyle(view);
            renderView(view);
        }

        function updateTabStyle(view) {
            document.querySelectorAll('.nav-item').forEach(el => {
                const isActive = el.dataset.target === view || (['services','staff','time','confirm','success'].includes(view) && el.dataset.target === 'services');
                el.className = `nav-item flex flex-col items-center space-y-1 w-1/4 ${isActive ? 'tab-active' : 'tab-inactive'}`;
            });
        }

        function renderView(view) {
            appContent.innerHTML = '';
            switch(view) {
                case 'home': appContent.innerHTML = renderHome(); break;
                case 'services': appContent.innerHTML = renderServices(); break;
                case 'staff': appContent.innerHTML = renderStaff(); break;
                case 'time': appContent.innerHTML = renderTimeSelection(); initCalendar(); break;
                case 'confirm': appContent.innerHTML = renderConfirmation(); break;
                case 'success': appContent.innerHTML = renderSuccess(); break;
                case 'records': appContent.innerHTML = renderRecords(); break;
                case 'profile': appContent.innerHTML = renderProfile(); break;
            }
        }

        // --- VIEW COMPONENTS (Simplified) ---
        function renderHome() {
            return `
                <div class="space-y-6 animate-fade-in">
                    <div class="w-full h-40 bg-gradient-to-r from-gray-800 to-gray-900 rounded-2xl flex items-center p-6 text-white relative overflow-hidden">
                        <div class="z-10">
                            <h2 class="text-xl font-bold">Hi, ${storeData.user.displayName}</h2>
                            <p class="text-xs opacity-70 mt-1">${storeData.user.isLineUser ? 'å·²ç¶å®š LINE å¸³è™Ÿ' : 'è¨ªå®¢æ¨¡å¼'}</p>
                            <button onclick="navigateTo('services')" class="mt-4 bg-[#06C755] text-white px-4 py-2 rounded-full text-sm font-bold shadow-md">ç«‹å³é ç´„</button>
                        </div>
                        ${storeData.user.pictureUrl ? `<img src="${storeData.user.pictureUrl}" class="absolute right-4 bottom-4 w-16 h-16 rounded-full border-2 border-white opacity-80">` : ''}
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div onclick="navigateTo('services')" class="bg-blue-50 p-4 rounded-xl flex flex-col items-center justify-center cursor-pointer hover:bg-blue-100">
                            <span class="text-3xl mb-2">âœ‚ï¸</span><span class="font-bold text-gray-700">ç¾é«®æœå‹™</span>
                        </div>
                        <div onclick="navigateTo('services')" class="bg-pink-50 p-4 rounded-xl flex flex-col items-center justify-center cursor-pointer hover:bg-pink-100">
                            <span class="text-3xl mb-2">ğŸ’…</span><span class="font-bold text-gray-700">ç¾ç”²æœå‹™</span>
                        </div>
                    </div>
                </div>`;
        }

        function renderServices() {
            return `<div class="space-y-3">
                <div class="flex items-center space-x-2 mb-2"><button onclick="navigateTo('home')">â€¹</button><h2 class="font-bold">é¸æ“‡æœå‹™</h2></div>
                ${storeData.services.map(s => `
                    <div onclick="selectService('${s.id}')" class="bg-white p-4 rounded-xl border border-gray-100 shadow-sm flex justify-between cursor-pointer hover:border-[#06C755]">
                        <div class="flex items-center space-x-3"><span class="text-2xl">${s.icon}</span><div><div class="font-bold">${s.name}</div><div class="text-xs text-gray-500">${s.duration} åˆ†é˜</div></div></div>
                        <div class="font-bold">NT$ ${s.price}</div>
                    </div>
                `).join('')}
            </div>`;
        }

        function renderStaff() {
             return `<div class="space-y-3">
                <div class="flex items-center space-x-2 mb-2"><button onclick="navigateTo('services')">â€¹</button><h2 class="font-bold">é¸æ“‡è¨­è¨ˆå¸«</h2></div>
                <div class="grid grid-cols-2 gap-3">
                ${storeData.staff.map(s => `
                    <div onclick="selectStaff('${s.id}')" class="bg-white p-4 rounded-xl border border-gray-100 shadow-sm text-center cursor-pointer hover:border-[#06C755]">
                        <div class="text-3xl mb-2">${s.image}</div><div class="font-bold">${s.name}</div>
                    </div>
                `).join('')}
                </div>
            </div>`;
        }

        function renderTimeSelection() {
            return `<div class="h-full flex flex-col">
                <div class="flex items-center space-x-2 mb-2"><button onclick="navigateTo('staff')">â€¹</button><h2 class="font-bold">é¸æ“‡æ™‚é–“</h2></div>
                <div class="bg-white p-4 rounded-xl border mb-4"><div id="calendarGrid" class="grid grid-cols-7 gap-1 text-center text-sm"></div></div>
                <div id="timeSlots" class="grid grid-cols-3 gap-2 overflow-y-auto"></div>
            </div>`;
        }

        function renderConfirmation() {
            const f = state.bookingFlow;
            return `<div class="space-y-4">
                <div class="flex items-center space-x-2 mb-2"><button onclick="navigateTo('time')">â€¹</button><h2 class="font-bold">ç¢ºèªè³‡æ–™</h2></div>
                <div class="bg-white p-5 rounded-xl border-t-4 border-[#06C755] shadow-sm space-y-3">
                    <div class="flex justify-between"><span class="text-gray-500">æœå‹™</span><span class="font-bold">${f.service.name}</span></div>
                    <div class="flex justify-between"><span class="text-gray-500">è¨­è¨ˆå¸«</span><span class="font-bold">${f.staff.name}</span></div>
                    <div class="flex justify-between"><span class="text-gray-500">æ™‚é–“</span><span class="font-bold text-[#06C755]">${f.date} ${f.time}</span></div>
                    <div class="flex justify-between pt-2 border-t"><span class="text-gray-500">è²»ç”¨</span><span class="font-bold">NT$ ${f.service.price}</span></div>
                </div>
                <input id="userNameInput" type="text" class="w-full p-3 border rounded-xl" placeholder="é ç´„å§“å" value="${storeData.user.displayName !== 'è¨ªå®¢' ? storeData.user.displayName : ''}">
                <input id="userPhoneInput" type="tel" class="w-full p-3 border rounded-xl" placeholder="è¯çµ¡é›»è©±" value="0912-345-678">
                <button id="submitBtn" onclick="submitBooking()" class="w-full bg-[#06C755] text-white py-3 rounded-xl font-bold shadow">ç¢ºèªé ç´„</button>
            </div>`;
        }

        function renderSuccess() {
            return `<div class="flex flex-col items-center justify-center h-full p-6 text-center animate-scale-in">
                <div class="text-6xl mb-4">âœ…</div>
                <h2 class="text-2xl font-bold mb-2">é ç´„æˆåŠŸï¼</h2>
                <p class="text-gray-500 text-sm mb-6">æˆ‘å€‘å·²æ”¶åˆ°æ‚¨çš„é ç´„ã€‚<br>è©³ç´°è³‡è¨Šå·²ç™¼é€è‡³æ‚¨çš„ç´€éŒ„ã€‚</p>
                <button onclick="navigateTo('records')" class="w-full bg-gray-100 py-3 rounded-xl font-bold">æŸ¥çœ‹ç´€éŒ„</button>
            </div>`;
        }
        
        function renderRecords() {
            const list = storeData.bookings.slice().reverse();
            return `<div class="space-y-3">
                <h2 class="font-bold text-xl mb-4">é ç´„ç´€éŒ„</h2>
                ${list.length === 0 ? '<div class="text-gray-400 text-center mt-10">å°šç„¡ç´€éŒ„</div>' : ''}
                ${list.map(b => `
                    <div class="bg-white p-4 rounded-xl border-l-4 border-[#06C755] shadow-sm">
                        <div class="font-bold text-lg">${b.serviceName}</div>
                        <div class="text-sm text-gray-500">è¨­è¨ˆå¸«: ${b.staffName}</div>
                        <div class="mt-2 flex justify-between text-sm">
                            <span>ğŸ“… ${b.date} ${b.time}</span>
                            <span class="font-bold text-[#06C755]">${b.status}</span>
                        </div>
                    </div>
                `).join('')}
            </div>`;
        }
        
        function renderProfile() {
            return `<div class="p-4 space-y-4">
                 <div class="flex items-center space-x-4">
                    ${storeData.user.pictureUrl ? `<img src="${storeData.user.pictureUrl}" class="w-16 h-16 rounded-full">` : '<div class="w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center">ğŸ‘¤</div>'}
                    <div><div class="font-bold text-xl">${storeData.user.displayName}</div><div class="text-xs text-gray-500">ID: ${storeData.user.userId.substring(0,8)}...</div></div>
                 </div>
                 <div class="bg-white rounded-xl shadow-sm p-4 text-center text-gray-500">æœƒå“¡ä¸­å¿ƒåŠŸèƒ½é–‹ç™¼ä¸­</div>
            </div>`;
        }

        // --- LOGIC FUNCTIONS ---
        function selectService(id) { state.bookingFlow.service = storeData.services.find(s => s.id === id); navigateTo('staff'); }
        function selectStaff(id) { state.bookingFlow.staff = storeData.staff.find(s => s.id === id); navigateTo('time'); }
        
        function initCalendar() {
            const grid = document.getElementById('calendarGrid');
            grid.innerHTML = '';
            for(let i=0; i<3; i++) grid.innerHTML += `<div></div>`; // offset
            for(let i=1; i<=30; i++) {
                grid.innerHTML += `<div onclick="selectDate(${i})" class="calendar-day hover:bg-green-50 p-2 rounded-full cursor-pointer" id="day-${i}">${i}</div>`;
            }
        }
        function selectDate(d) {
            document.querySelectorAll('.calendar-day').forEach(el => el.classList.remove('selected', 'bg-[#06C755]', 'text-white'));
            const el = document.getElementById(`day-${d}`);
            el.classList.add('selected', 'bg-[#06C755]', 'text-white');
            state.bookingFlow.date = `2023-10-${d}`;
            
            const times = ['10:00', '11:00', '13:00', '14:30', '16:00', '19:00'];
            document.getElementById('timeSlots').innerHTML = times.map(t => 
                `<button onclick="selectTime('${t}')" class="border p-2 rounded hover:border-[#06C755]">${t}</button>`
            ).join('');
        }
        function selectTime(t) { state.bookingFlow.time = t; navigateTo('confirm'); }

        // --- SUBMIT LOGIC (Connect to Backend) ---
        async function submitBooking() {
            const btn = document.getElementById('submitBtn');
            btn.innerText = 'è™•ç†ä¸­...';
            btn.disabled = true;

            const name = document.getElementById('userNameInput').value;
            const phone = document.getElementById('userPhoneInput').value;
            
            const bookingData = {
                userId: storeData.user.userId,
                userName: name,
                userPhone: phone,
                serviceName: state.bookingFlow.service.name,
                staffName: state.bookingFlow.staff.name,
                price: state.bookingFlow.service.price,
                date: state.bookingFlow.date,
                time: state.bookingFlow.time,
                status: 'å·²é ç´„',
                timestamp: new Date().toISOString()
            };

            // 1. æœ¬åœ°å„²å­˜ (æ¨¡æ“¬)
            storeData.bookings.push(bookingData);

            // 2. å‚³é€è‡³å¾Œç«¯ (çœŸå¯¦ä¸²æ¥)
            if (BACKEND_URL) {
                try {
                    // ä½¿ç”¨ fetch å‚³é€ POST è«‹æ±‚ (no-cors æ¨¡å¼é©ç”¨äº GAS)
                    await fetch(BACKEND_URL, {
                        method: 'POST',
                        mode: 'no-cors', 
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(bookingData)
                    });
                    console.log('Data sent to backend');
                } catch (e) {
                    console.error('Backend Error', e);
                    alert('å¾Œç«¯é€£ç·šå¤±æ•—ï¼Œä½†æœ¬åœ°æ¨¡æ“¬å·²å®Œæˆ');
                }
            } else {
                console.log('æ¨¡æ“¬æ¨¡å¼ï¼šç„¡å¾Œç«¯ URLï¼Œè³‡æ–™åƒ…æš«å­˜æ–¼å‰ç«¯ã€‚');
                await new Promise(r => setTimeout(r, 1000)); // å‡è£è·‘ä¸€ä¸‹
            }

            // 3. å˜—è©¦ç™¼é€ LINE è¨Šæ¯ (é€é LIFF)
            if (storeData.user.isLineUser && liff.isInClient()) {
                try {
                    await liff.sendMessages([{
                        type: 'text',
                        text: `ã€é ç´„æˆåŠŸã€‘\næ‚¨å·²é ç´„ ${bookingData.date} ${bookingData.time}\né …ç›®ï¼š${bookingData.serviceName}`
                    }]);
                } catch (err) {
                    console.error('LIFF Message Error', err);
                }
            }

            navigateTo('success');
        }

        // --- DASHBOARD (Mock) ---
        function initCharts() {
            new Chart(document.getElementById('revenueChart'), {
                type: 'line', data: { labels: ['D1','D2','D3','D4','D5'], datasets: [{ label: 'ç‡Ÿæ”¶', data: [5000, 7000, 4500, 8000, 6000], borderColor: '#06C755' }] }, options: { maintainAspectRatio: false }
            });
            new Chart(document.getElementById('categoryChart'), {
                type: 'doughnut', data: { labels: ['å‰ªé«®','æŸ“é«®','è­·ç†'], datasets: [{ data: [10, 5, 3], backgroundColor: ['#93C5FD','#F9A8D4','#86EFAC'] }] }, options: { maintainAspectRatio: false }
            });
        }

        // --- STARTUP ---
        // Dashboard toggle
        document.getElementById('mobile-toggle').onclick = () => {
            const d = document.getElementById('admin-dashboard');
            const c = document.getElementById('client-app');
            d.classList.toggle('hidden'); c.classList.toggle('hidden');
        };

        // Init
        window.onload = () => {
            initLiff(); // Try connecting to LINE
            navigateTo('home');
            setTimeout(initCharts, 500);
        };

        // Inject Styles
        const style = document.createElement('style');
        style.innerHTML = `
            @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
            .animate-fade-in { animation: fadeIn 0.4s ease-out forwards; }
            @keyframes scaleIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
            .animate-scale-in { animation: scaleIn 0.3s ease-out forwards; }
        `;
        document.head.appendChild(style);

    </script>
</body>
</html>
```

### ç¬¬äºŒéšæ®µï¼šè©³ç´°å¯¦ä½œæ•™å­¸ (Step-by-Step)

è«‹ä¾ç…§ä»¥ä¸‹æ­¥é©Ÿï¼Œå°‡ä¸Šé¢çš„ HTML è®ŠæˆçœŸæ­£çš„ LINE é ç´„ç³»çµ±ã€‚

#### æ­¥é©Ÿ 1ï¼šç”³è«‹ LINE Developers å¸³è™Ÿ
1.  å‰å¾€ [LINE Developers Console](https://developers.line.biz/)ã€‚
2.  ç™»å…¥æ‚¨çš„ LINE å¸³è™Ÿã€‚
3.  å»ºç«‹ä¸€å€‹æ–°çš„ **Provider** (æä¾›è€…ï¼Œä¾‹å¦‚ã€Œæˆ‘çš„ç¾é«®åº—ã€)ã€‚
4.  å»ºç«‹ä¸€å€‹æ–°çš„ **Channel**ï¼Œé¡å‹é¸æ“‡ **LINE Login** (é€™æ˜¯ LIFF å¿…é ˆçš„)ã€‚
    * App type å‹¾é¸ Web appã€‚
5.  åœ¨ Channel é é¢ä¸­ï¼Œæ‰¾åˆ° **LIFF** é ç±¤ï¼Œé»æ“Š **Add**ã€‚
    * **Size**: å»ºè­°é¸ Full æˆ– Tallã€‚
    * **Endpoint URL**: é€™è£¡å…ˆéš¨ä¾¿å¡« (ä¾‹å¦‚ `https://www.google.com`)ï¼Œç­‰ä¸€ä¸‹æˆ‘å€‘æ¶å¥½ç¶²é å†å›ä¾†æ”¹ã€‚
    * **Scopes**: å‹¾é¸ `profile` å’Œ `openid`ã€‚
6.  å»ºç«‹å¾Œï¼Œæ‚¨æœƒå¾—åˆ°ä¸€ä¸² **LIFF ID** (ä¾‹å¦‚ `165700XXXX-AbCdEfGh`)ã€‚
    * **å‹•ä½œ**ï¼šæŠŠé€™ä¸² ID è¤‡è£½èµ·ä¾†ï¼Œå¡«å…¥ä¸Šé¢ç¨‹å¼ç¢¼ä¸­çš„ `const LIFF_ID = "é€™è£¡";`ã€‚

#### æ­¥é©Ÿ 2ï¼šæ¶è¨­å¾Œç«¯ (Google Sheets + Apps Script)
é€™èƒ½è®“æ‚¨çš„é ç´„è³‡æ–™æœ‰åœ°æ–¹å­˜ï¼Œè€Œä¸æ˜¯é‡æ–°æ•´ç†å°±æ¶ˆå¤±ã€‚

1.  å»ºç«‹ä¸€å€‹æ–°çš„ **Google è©¦ç®—è¡¨ (Google Sheets)**ã€‚
2.  ç¬¬ä¸€åˆ— (Row 1) å¡«å…¥æ¨™é¡Œï¼š`æ—¥æœŸ`, `æ™‚é–“`, `å§“å`, `é›»è©±`, `æœå‹™`, `è¨­è¨ˆå¸«`, `åƒ¹æ ¼`, `LINE ID`ã€‚
3.  é»æ“Šä¸Šæ–¹é¸å–® **æ“´å……åŠŸèƒ½ (Extensions)** > **Apps Script**ã€‚
4.  å°‡ç·¨è¼¯å™¨å…§çš„ç¨‹å¼ç¢¼å…¨éƒ¨åˆªé™¤ï¼Œè²¼ä¸Šä»¥ä¸‹é€™æ®µå¾Œç«¯ç¨‹å¼ç¢¼ï¼š

```javascript
// Google Apps Script å¾Œç«¯ç¨‹å¼ç¢¼
function doPost(e) {
  try {
    var data = JSON.parse(e.postData.contents);
    var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
    
    // å¯«å…¥è³‡æ–™åˆ°è©¦ç®—è¡¨
    sheet.appendRow([
      new Date(), // ç´€éŒ„æ™‚é–“
      data.date + ' ' + data.time,
      data.userName,
      data.userPhone,
      data.serviceName,
      data.staffName,
      data.price,
      data.userId
    ]);
    
    return ContentService.createTextOutput(JSON.stringify({result: "success"}))
      .setMimeType(ContentService.MimeType.JSON);
      
  } catch(error) {
    return ContentService.createTextOutput(JSON.stringify({result: "error", error: error.message}))
      .setMimeType(ContentService.MimeType.JSON);
  }
}